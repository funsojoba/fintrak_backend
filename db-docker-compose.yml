services:
 db:
    image: 'postgres:12'
    container_name: db
    volumes:
      - ./tmp/db:/var/lib/postgresql/data
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres
      - POSTGRES_DBNAME=postgres
    ports:
      - '5432:5432'
    networks:
      - fintrak-api-network
celery_beat:
  build: .
  command:
    [
      'celery',
      '--app=PROJECT',
      'beat',
      '--scheduler=django_celery_beat.schedulers:DatabaseScheduler',
      '--loglevel=INFO',
    ]
  volumes:
    - ./:/app
  depends_on:
    - web
    - redis

redis:
    image: redis:alpine
    container_name: fintra_redis

celery:
  build: .
  command: celery -A PROJECT.celery worker -l info
  volumes:
    - .:/app
  depends_on:
    - web
    - redis


  mailhog:
    image: mailhog/mailhog:latest
    restart: always
    ports:
      - 1026:1025
      - 8026:8025

networks:
  fintrak-api-network:
    driver: bridge
